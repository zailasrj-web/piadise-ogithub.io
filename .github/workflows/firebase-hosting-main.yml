name: Deploy to Firebase Hosting on push to main

# Se ejecuta cuando haces push a main
on:
  push:
    branches:
      - main

permissions:
  contents: read
  checks: write

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      # 1️⃣ Clonar el repo
      - uses: actions/checkout@v4

      # 2️⃣ Configurar Node.js compatible con Firebase CLI
      - uses: actions/setup-node@v3
        with:
          node-version: 24   # Firebase CLI requiere Node >=20

      # 3️⃣ Deploy a Firebase Hosting
      - uses: FirebaseExtended/action-hosting-deploy@v0
        with:
          repoToken: ${{ secrets.GITHUB_TOKEN }}
          firebaseServiceAccount: ${{ secrets.FIREBASE_SERVICE_ACCOUNT_PIA_PAGINAS_WEB }}
          projectId: pia-paginas-web
          channelId: live       # Puedes usar 'main-preview' si quieres un canal de prueba
          entryPoint: .         # Carpeta raíz del proyecto
          force: true

